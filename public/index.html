<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EMPLB8PQ64"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-EMPLB8PQ64');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1430054911512403"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FireTool</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="icon" href="https://www.gstatic.com/devrel-devsite/prod/v8c8ec5f90d3e078ddd668309d42cb633e54798872586821a55652000226f878b/firebase/images/touchicon-180.png" type="image/png">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-direction: row;
      height: 100vh;
      margin: 0;
      background: #f4f4f9;
      padding: 20px;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    form {
      background: white;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
      width: 90%;
      max-width: 500px;
      margin-right: 20px;
      box-sizing: border-box;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: 600;
    }
    button {
      font-family: 'Inter', sans-serif;
    }
    .tooltip {
      display: inline-block;
      position: relative;
      cursor: pointer;
      color: #007BFF;
      margin-left: 5px;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%; /* Position the tooltip above the icon */
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    input[type="text"],
    input[type="file"] {
      width: calc(100% - 20px);
      padding: 10px;
      margin-bottom: 20px;
      border: 2px solid #ddd;
      border-radius: 8px;
    }
    .file-drop-area {
      padding: 40px;
      border: 2px dashed #ddd;
      background: #f9f9f9;
      position: relative;
      cursor: pointer;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .file-drop-area.dragging {
      background: #e6f7ff;
    }
    .file-drop-area::before {
      content: 'Drop a file here or click to upload';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #999;
      font-weight: 400;
      pointer-events: none;
    }
    .file-name {
      margin-top: -15px;
      margin-bottom: 20px;
      color: #333;
      font-weight: 400;
      font-size: 14px;
      display: none;
    }
    input[type="file"] {
      opacity: 0;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    button {
      background: #007BFF;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #0056b3;
    }
    .disclaimer {
      font-size: 12px;
      color: #666;
      margin-top: 20px;
      text-align: center;
    }
    .loading-spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
      display: inline-block;
      margin-right: 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .content {
      max-width: 800px;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .content h2 {
      font-size: 24px;
      margin-bottom: 10px;
    }
    .content p {
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 20px;
    }
    .content ul {
      list-style-type: disc;
      padding-left: 20px;
      margin-bottom: 20px;
    }
    .content li {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .ads-space {
      height: 100px; /* Adjust the height as needed */
      margin-bottom: 20px;
      background: #f9f9f9;
      border: 1px dashed #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 14px;
      font-style: italic;
    }
  </style>
</head>
<body>
  <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data">
    <h1>Firebase Firestore Bulk Update</h1>
    <label for="serviceAccount">Service Account File:
      <span class="tooltip">?
        <span class="tooltiptext">You can generate one in your Firebase project settings.</span>
      </span>
    </label>
    <div class="file-drop-area" id="fileDropArea">
      <input type="file" id="serviceAccount" name="serviceAccount" accept=".json" required>
    </div>
    <div class="file-name" id="fileName"></div>
    <label for="collectionPath">Collection Path (with / after):</label>
    <input type="text" id="collectionPath" name="collectionPath" required placeholder="Example: /people/"><br>
    <label for="fieldName">Field Name:</label>
    <input type="text" id="fieldName" name="fieldName" required placeholder="Entering a field that doesn't exist will create it."><br>
    <label for="fieldValue">New Field Value:</label>
    <input type="text" id="fieldValue" name="fieldValue"><br>

    <button type="submit" id="submitButton">Update</button>
    <div class="disclaimer">Service account credentials are not stored.</div>
  </form>
  
  <div class="content">
    <h2>About FireTool</h2>
    <div class="ads-space">Ads Space</div>
    <p>FireTool is an innovative solution designed to simplify bulk updates in Firebase Firestore. It enables users to quickly and efficiently update multiple documents within a Firestore collection. Our tool is built with user experience in mind, ensuring that even those with minimal technical knowledge can perform bulk updates with ease.</p>
    <h2>Features</h2>
    <ul>
      <li><strong>Ease of Use:</strong> Simple drag-and-drop interface for uploading service account files.</li>
      <li><strong>Secure:</strong> Service account credentials are not stored and are only used for the current session.</li>
      <li><strong>Flexible:</strong> Allows updating of any field within a Firestore collection. If the field does not exist, it will be created.</li>
    </ul>
    <div class="ads-space">Ads Space</div>
    <h2>How It Works</h2>
    <p>Using FireTool is straightforward. Simply upload your Firebase service account JSON file, specify the collection path, the field name, and the new field value. Click 'Update' and FireTool will handle the rest, ensuring that all specified documents in the collection are updated accordingly.</p>
    <h2>Benefits of Using FireTool</h2>
    <ul>
      <li><strong>Time-Saving:</strong> Quickly perform bulk updates that would otherwise require extensive manual work.</li>
      <li><strong>Accuracy:</strong> Minimize the risk of errors that can occur with manual data entry.</li>
      <li><strong>Efficiency:</strong> Streamline your workflow and enhance productivity by automating routine tasks.</li>
    </ul>
    <div class="ads-space">Ads Space</div>
    <h2>Contact Us</h2>
    <p>If you have any questions or need further assistance, feel free to reach out to our support team at <a href="mailto:support@firetool.com">support@firetool.com</a>.</p>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const fileInput = document.getElementById('serviceAccount');
      const fileDropArea = document.getElementById('fileDropArea');
      const fileNameDisplay = document.getElementById('fileName');
      const form = document.getElementById('uploadForm');
      const submitButton = document.getElementById('submitButton');

      const displayFileName = (file) => {
        if (file && file.name) {
          fileNameDisplay.textContent = `File selected: ${file.name}`;
          fileNameDisplay.style.display = 'block';
        } else {
          fileNameDisplay.textContent = '';
          fileNameDisplay.style.display = 'none';
        }
      };

      fileDropArea.addEventListener('dragover', (event) => {
        event.preventDefault();
        event.stopPropagation();
        fileDropArea.classList.add('dragging');
      });

      fileDropArea.addEventListener('dragleave', (event) => {
        event.preventDefault();
        event.stopPropagation();
        fileDropArea.classList.remove('dragging');
      });

      fileDropArea.addEventListener('drop', (event) => {
        event.preventDefault();
        event.stopPropagation();
        fileDropArea.classList.remove('dragging');
        const files = event.dataTransfer.files;
        if (files.length && files[0].type === 'application/json') {
          fileInput.files = files;
          displayFileName(files[0]);
        } else {
          alert('Please upload a valid JSON file.');
          fileInput.value = '';  // Clear the input
          displayFileName(null);
        }
      });

      fileInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file && file.type === 'application/json') {
          displayFileName(file);
        } else {
          alert('Please upload a valid JSON file.');
          fileInput.value = '';  // Clear the input
          displayFileName(null);
        }
      });

      form.addEventListener('submit', (event) => {
        event.preventDefault();
        submitButton.disabled = true;
        submitButton.innerHTML = 'Updating...';

        const formData = new FormData(form);

        fetch('/upload', {
          method: 'POST',
          body: formData
        })
        .then(response => response.text())
        .then(result => {
          alert(result);
          submitButton.disabled = false;
          submitButton.innerHTML = 'Update';
        })
        .catch(error => {
          alert('Error: ' + error.message);
          submitButton.disabled = false;
          submitButton.innerHTML = 'Update';
        });
      });
    });
  </script>
</body>
</html>
